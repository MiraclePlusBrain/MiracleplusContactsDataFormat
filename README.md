# 人脉数据上传格式化工具

通过各个渠道爬取或者获得的数据通常具有完全不同的格式，但在上传人脉的过程中又需要把这些不同的数据标准化为模板格式。在这个标准化的过程中，工作较为机械化，可以通过代码来自动化。本工具即为了解决这一问题。

根据这一工具的逻辑，数据格式化的过程需要分成两步：

- **【Step 1】预处理**

将某一来源的数据中**不需要的数据维度**删除（例如工商数据中的工商注册号就不需要），将需要的数据维度的名字修改为模板中对应的名字，将不完整的信息拼接（例如工商数据中会把省份和城市分两栏，需要将省份和城市拼接然后放在标准模板的”城市“中）

不同来源的数据在这一步中使用的代码一致。github中的”Step1“文件夹就是执行这一步的。

- **【Step 2】格式化**

github中的”Step2“文件夹就是执行这一步的。这一步的逻辑是：将输入文件A中的数据维度中，**名字和模板一致的直接放入模板中，不一致的彼此间以分号相连全部放到备注中。**



## 主要功能

#### 1、格式化不同来源的数据

尤其是”天眼查高级搜索导出“或者”天眼查批量搜索导出“，可实现从下载到上传全流程自动化。而对于非这两个来源的数据（例如从linkin爬取的数据），还需要手动进行预处理，才能够运行Step2 的代码。

#### 2、无手机号自动填充

对于linkin等来源的数据，本身不具有手机号/邮箱/微信号，而是具有linkin链接。但是又需要通过人脉发放数据，而人脉上传的规则是必须具有手机号/邮箱/微信号。此时可使用该功能，生成一个能通过查重的手机号信息，该手机号为**”无手机号+月+日+小时+分+秒+该数据在这一次上传中的行标“**，示例：无手机号1010162110102

#### 3、无用线索筛选（通过CCC前期积累的关键词）

CCC在前期的工作中发现，具有某些关键词的企业通常不是目标企业。因此本功能在**公司注册名称、一句话介绍、行业赛道**中搜索一些关键词（储存在key_word内），并且输出通过筛选和未通过筛选的两份数据。



## 使用方式

#### 【Step 1】安装R语言环境

https://mirrors.tuna.tsinghua.edu.cn/CRAN/

只需安装基础的R即可，不需要下载额外的IDE（例如Rstudio）

#### 【Step 2】第一次运行时请安装下列包

在console内依次输入

```R
install.packages('readxl')
install.packages('openxlsx')
install.packages('stringr')
```

#### 【Step 3】确定数据来源

- 如果是”天眼查高级搜索导出“或者”天眼查批量搜索导出“的数据的话，可以下载”Step1“文件夹中的对应文件。将需要处理的文件中的前两行删去（如下图）：

  ![image-20220109101950031](https://github.com/MiraclePlusBrain/MiracleplusContactsDataFormat/blob/main/img_storage/plot1.png)

接着保证需要运行的文件与代码文件在同一路径中，运行代码即可接着进行下一步

- 如果是非上述来源的数据的话，需要**自行进行预处理**（即将数据中**不需要的数据维度**删除，将需要的数据维度的名字修改为模板中对应的名字）

#### 【Step 4】下载对应文件夹

并在文件夹内创建一个新的空文件夹（要格式化的文档放这里），命名如下：

<img src="https://github.com/MiraclePlusBrain/MiracleplusContactsDataFormat/blob/main/img_storage/plot2.png" alt="image-20220109102753566" style="zoom:80%;" />

其中人脉导入结构化为核心代码，刚创建的新文件夹用来存放需要格式化的数据文件

#### 【Step 5】将已进行预处理的数据放至刚创建的新文件夹

注意：格式需要为xlsx、可以一次放多个文件（会自动合并到一起）

#### 【Step 6】添加额外信息

打开”额外添加的信息“文件，在对应位置填充内容

- 来源备注。这里如实填写就好，需要方便接收数据的人搜索到

- 无手机号是否填充。填写”是“执行这一功能，”否“则忽略这一功能

- 是否批量变更奇绩负责人。填写”否“则忽略这一功能，填写任意人名（需要和人脉系统内的人名对应），则在最后上传的时候会将对应数据自动分配至对应用户。

- 是否进行关键词筛选。填写”是“执行这一功能，代码会产出两个文件，一个为通过筛选的数据，另一个为未通过筛选的。”否“则忽略这一功能。

#### 【Step 7】运行代码&查看结果

运行”人脉导入结构化“r文件，查看文件夹中多出的文件：（此处使用了”关键词筛选功能“）

<img src="https://github.com/MiraclePlusBrain/MiracleplusContactsDataFormat/blob/main/img_storage/plot3.png" alt="image-20220109103922864" style="zoom:80%;" />

文件名中最后的数字是该数据文件的行数。现在就可以将这两个文件上传至奇绩人脉了



## 注意事项

- 要格式化的文件需要是xlsx后缀
- 注意读取的文件最后面有没有完全空的列(要删除)
- 注意预先调整时间变量为标准格式（即‘2021-10-10’或'2021/10/10'），例如”2021-10“是不行的
